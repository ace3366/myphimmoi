{"ast":null,"code":"import{useState,useEffect}from\"react\";export function useHttpTrailer(trailerExtract){const[inviMov,setInviMov]=useState(null);const[trailerData,setTrailerData]=useState({});const[isLoading,setIsLoading]=useState(true);const API_KEY=\"292c6915aed6c1ea24bb47d8b5d3ca92\";function infoHandler(choosenMov){// Kiểm tra cú click này có trùng movie với lần trước không\n// Nếu trùng thì đóng phần info\n// Nếu không thì hiện info movie khác\nsetInviMov(prevMov=>prevMov===choosenMov?null:choosenMov);}useEffect(()=>{async function sendRequest(){setIsLoading(true);try{// Gửi request lấy trailer\nconst request=await fetch(\"https://api.themoviedb.org/3/movie/\".concat(inviMov&&inviMov.id,\"/videos?api_key=\").concat(API_KEY,\" \"));const resData=await request.json();// Lấy dữ liệu trailer, nếu không có kết quả nào thoả thì trả về null\n// Lưu thông tin trailer nhận được\nsetTrailerData(trailerExtract(resData));if(!request.ok){throw new Error(\"Failed to fetch movie\");}}catch(err){console.error(err);// Nếu không fetch được data trailer thì thực hiện chức năng như bình thường\n// Đồng thời cho dữ liệu trailer là null để hiển thị backdrop thay thế\nsetTrailerData(null);}setIsLoading(false);}sendRequest();},[inviMov]);return{inviMov,trailerData,isLoading,infoHandler};}","map":{"version":3,"names":["useState","useEffect","useHttpTrailer","trailerExtract","inviMov","setInviMov","trailerData","setTrailerData","isLoading","setIsLoading","API_KEY","infoHandler","choosenMov","prevMov","sendRequest","request","fetch","concat","id","resData","json","ok","Error","err","console","error"],"sources":["D:/WORK/Submit/RJS301x_1.0-A_VN/Assignment 02 (Starter Code)/src/pages/hooks/useHttpTrailer.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nexport function useHttpTrailer(trailerExtract) {\r\n  const [inviMov, setInviMov] = useState(null);\r\n  const [trailerData, setTrailerData] = useState({});\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const API_KEY = \"292c6915aed6c1ea24bb47d8b5d3ca92\";\r\n\r\n  function infoHandler(choosenMov) {\r\n    // Kiểm tra cú click này có trùng movie với lần trước không\r\n    // Nếu trùng thì đóng phần info\r\n    // Nếu không thì hiện info movie khác\r\n    setInviMov((prevMov) => (prevMov === choosenMov ? null : choosenMov));\r\n  }\r\n  useEffect(() => {\r\n    async function sendRequest() {\r\n      setIsLoading(true);\r\n      try {\r\n        // Gửi request lấy trailer\r\n        const request = await fetch(\r\n          `https://api.themoviedb.org/3/movie/${\r\n            inviMov && inviMov.id\r\n          }/videos?api_key=${API_KEY} `\r\n        );\r\n        const resData = await request.json();\r\n        // Lấy dữ liệu trailer, nếu không có kết quả nào thoả thì trả về null\r\n        // Lưu thông tin trailer nhận được\r\n        setTrailerData(trailerExtract(resData));\r\n        if (!request.ok) {\r\n          throw new Error(\"Failed to fetch movie\");\r\n        }\r\n      } catch (err) {\r\n        console.error(err);\r\n        // Nếu không fetch được data trailer thì thực hiện chức năng như bình thường\r\n        // Đồng thời cho dữ liệu trailer là null để hiển thị backdrop thay thế\r\n        setTrailerData(null);\r\n      }\r\n      setIsLoading(false);\r\n    }\r\n\r\n    sendRequest();\r\n  }, [inviMov]);\r\n\r\n  return {\r\n    inviMov,\r\n    trailerData,\r\n    isLoading,\r\n    infoHandler,\r\n  };\r\n}\r\n"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAO,SAAS,CAAAC,cAAcA,CAACC,cAAc,CAAE,CAC7C,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGL,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACM,WAAW,CAAEC,cAAc,CAAC,CAAGP,QAAQ,CAAC,CAAC,CAAC,CAAC,CAClD,KAAM,CAACQ,SAAS,CAAEC,YAAY,CAAC,CAAGT,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAAAU,OAAO,CAAG,kCAAkC,CAElD,QAAS,CAAAC,WAAWA,CAACC,UAAU,CAAE,CAC/B;AACA;AACA;AACAP,UAAU,CAAEQ,OAAO,EAAMA,OAAO,GAAKD,UAAU,CAAG,IAAI,CAAGA,UAAW,CAAC,CACvE,CACAX,SAAS,CAAC,IAAM,CACd,cAAe,CAAAa,WAAWA,CAAA,CAAG,CAC3BL,YAAY,CAAC,IAAI,CAAC,CAClB,GAAI,CACF;AACA,KAAM,CAAAM,OAAO,CAAG,KAAM,CAAAC,KAAK,uCAAAC,MAAA,CAEvBb,OAAO,EAAIA,OAAO,CAACc,EAAE,qBAAAD,MAAA,CACJP,OAAO,KAC5B,CAAC,CACD,KAAM,CAAAS,OAAO,CAAG,KAAM,CAAAJ,OAAO,CAACK,IAAI,CAAC,CAAC,CACpC;AACA;AACAb,cAAc,CAACJ,cAAc,CAACgB,OAAO,CAAC,CAAC,CACvC,GAAI,CAACJ,OAAO,CAACM,EAAE,CAAE,CACf,KAAM,IAAI,CAAAC,KAAK,CAAC,uBAAuB,CAAC,CAC1C,CACF,CAAE,MAAOC,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC,CAClB;AACA;AACAhB,cAAc,CAAC,IAAI,CAAC,CACtB,CACAE,YAAY,CAAC,KAAK,CAAC,CACrB,CAEAK,WAAW,CAAC,CAAC,CACf,CAAC,CAAE,CAACV,OAAO,CAAC,CAAC,CAEb,MAAO,CACLA,OAAO,CACPE,WAAW,CACXE,SAAS,CACTG,WACF,CAAC,CACH","ignoreList":[]},"metadata":{},"sourceType":"module"}